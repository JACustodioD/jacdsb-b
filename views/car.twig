{% extends "templates/index.twig" %}

{% block title %} {{ parent() }} {{ " | Carrito" }} {% endblock %}

{% block header %} 
    {% include('templates/nav.twig') %}
{% endblock %}

{% block main %}

  <!-- SECTION CAR -->
  <section>
    <div class="container">
      <div class="row">
        <div class="col-12">
        <h2 class="text-center">Carrito</h2>

        <div class="table-responsive">
            <table class="table text-center">
              <thead>
                <tr>
                  <th scope="col">Producto</th>
                  <th scope="col">Cantidad</th>
                  <th scope="col">Precio</th>
                  <th scope="col">Total</th>
                  <th scope="col">Eliminar</th>
                </tr>
              </thead>
              <tbody id="table-content">
                
              </tbody>
              <tfooter>
                <tr>
                  <th scope="col"></th>
                  <th scope="col"></th>
                  <th scope="col"></th>
                  <th scope="col">Total</th>
                  <th scope="col" id="total_car"></th>
                </tr>
                <tr>
                  <th scope="col"></th>
                  <th scope="col"></th>
                  <th scope="col"></th>
                  <th scope="col"></th>
                  <th scope="col"><button class="btn btn-warning">Pagar</button></th>
                </tr>
              </tfooter>
            </table>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- SECTION CAR -->

{% endblock %}

{% block extraScript %}
      <script>

    $(document).ready(function(){
      show_car_items();


      $(document).on("change", ".amount_item", function(){
        let value = $(this).val();
        let product = $(this).attr("product");
        
        if(value <= 0 ) {
          $(this).val(1);
          value = 1;
        } 
        update_car(product, value);

      });

      $(document).on("click", ".btn-delete", function(){
        let product = $(this).attr("product");

        let confirm_delete = confirm("Â¿Desea eliminar este producto?");

        if(confirm_delete) {
          if(delete_product(product) ) {
                ohSnap('Producto eliminado', {color: 'green', duration:'2000',icon:'fas fa-check-circle'});
          } else {
            ohSnap('El producto no se encontro revise su carrito', {color: 'red', duration:'2000',icon:'fas fa-exclamation-circle'});
          }
        } 

        amount_items();
        show_car_items();

      });
      
    });
    
</script>

{% endblock %}